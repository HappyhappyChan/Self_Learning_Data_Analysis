# 概率论与数理统计

## 随机事件与概率

### 基本概念

#### 随机试验(E)

```
一个试验为随机试验，如果它满足以下三个条件：
（1）试验可以在相同的条件下重复进行
（2）试验所有可能结果是明确可知道的，并且不止一个
（3）每一次试验会出现哪一个结果，事先不能确定
随机试验简称为试验，并用字母E表示
```

#### 随机事件

```
def1: 在一次试验中，可能出现也可能不出现的结果称为随机事件，简称为事件，并用大写字母A,B,C等表示。
def2: 随机试验E的样本空间S的子集称为随机事件
必然事件：每次试验中一定发生的事件 Ω
不可能事件：每次试验中一定不发生的事件，记为 ∅
```

#### 样本点

```
随机试验的每一个可能结果称为样本点，记为 w
```

#### 基本事件

```
样本空间的单个元素，一个可能结果构成的集合
```

#### 样本空间(S)

```
样本点的全体组成的集合称为样本空间（或基本事件空间），即为Ω={w}
随机事件A总是由若干个基本事件组成，即A是Ω的子集
```

#### 事件的关系与运算

包含：事件A发生必导致事件B发生，事件B包含事件A，A被B包含

相等：

A与B的积(交)：事件A与B同时发生，记作A∩B或AB

相容、互斥

A与B的和(并)：事件A与B至少有一个发生

A的逆事件或对立事件：事件A不发生

完备事件组：

#### 运算法则

（1）吸收律

（2）交换律

（3）结合律

（4）分配律

（5）对偶律（德摩根律）

#### 概率

##### 定义

```
描述性定义：将随机事件A发生的可能性大小的度量（非负值），称为事件A发生的概率，记为 P(A)
统计性定义：在相同条件下做重复试验，事件A出现的次数k和总的试验次数n之比k/n，称为事件A在这n次试验中出现的频率，当试验次数n充分大时，频率将"稳定"于某常数p的附件，n越大，频率偏离这个常数p的可能性越小，这个常数p就称为事件A的概率。
```

##### 公理化定义

(1) 非负性 P(A) >= 0;

(2) 规范性，P=1表示必然事件，等于P(S) ; 

(3) 可列可加性（互不相容事件)

##### 性质

1. 有界性。对任一事件A，有$0 \leq P(A) \leq1$，且$P(\empty)=0,P(\Omega)=1$

2. 单调性，设A，B是两个事件，若$A \subset B$，则有
   $$
   P(B-A)=P(B)-P(A),P(B) \geq P(A)
   $$
   

#### 古典概型（等可能概型）

称随机试验（随机现象）的概率模型为古典概型，如果其样本空间（基本事件空间）满足：

```
1. 只有有限个样本点(基本事件)
2. 每个样本点(基本事件)发生的可能性都一样
长期实践的发现：“概率很小的事件在一次试验中几乎是不发生”（称之为实际推理原理）
```

#### 几何概型

称随机试验（随机现象）的概率模型为几何概型，如果：

```
1. 样本空间(基本事件空间)Ω是一个可度量的有界区域
2. 每个样本点(基本事件)发生的可能性都一样，即样本点落入Ω的某一可度量的子区域S的可能性大小与S的几何度量成正比，而与S的位置和形状无关
```

在几何概型随机试验中，如果S_A是样本空间Ω的一个可度量的子区域，则事件A={样本点落入区域S_A}的概率为
$$
P(A)=\frac{S_A的几何度量}{Ω的几何度量}
$$

#### 条件概率

```
假设A和B是试验E的事件，考虑A已经发生的情况下B发生的概率：P(B|A) = P(AB) / P(A)；满足概率的三个基本性质。
乘法公式：P(AB) = P(A)P(B|A)
事件S的划分：B1, ... ,Bi, ... Bn
全概率公式：P(A) = P(A|B1) + ... + P(A|Bi) + ...+ P(A|Bn)
贝叶斯公式：P(Bi|A) = P(BiA)/P(A) = P(A|Bi)P(Bi) / (P(A|B1) + ... + P(A|Bi) + ...+ P(A|Bn))
```

**注意：**贝叶斯公式：P(A) > 0, P(Bi) > 0

条件概率P(* | A)是概率，概率的一切性质和重要结论对条件概率都适用
$$
P(\overline{B}|A)= 1- P(B|A) \\
P(B-C|A)=P(B|A)-P(C|A)
$$

#### 事件的独立性

描述性定义：设A,B为两个事件，如果其中任何一个事件发生的概率不受另一个事件发生与否的影响，则称事件A与B相互独立，设A1,A2,...,An是n(n>=2)个事件，如果其中任何一个或几个事件发生的概率都不受其余的某一个或几个事件发生与否的影响，则称事件A1,A2,..,An相互独立。

数学定义：A,B为两个事件，若P(AB)=P(A)P(B)，则称事件A与B相互独立，简称为A与B独立，即A和B两个事件的发生互不影响

**定理1：**若P(A) > 0 ，且 P(B|A) = P(B) 等价于 AB相互独立
**定理2：**若AB相互独立，则其对立事件也相互独立
可以很自然的推广到n个事件的情况

#### n重伯努利概型

在同样条件下独立重复地进行一系列完全相同的试验，即每次试验结果及其发生的概率都不变，各次试验是相互独立的，称这种重复试验序列的数学模型为**独立试验序列概型**。如果每次实验只有两个结果A与$\overline A$，且在每次试验中A发生的概率都相等，即P(A)=p，将这种试验独立重复n次，则称这种试验为**n重伯努利概型**。

## 一维随机变量及其分布

### 随机变量

定义在样本空间上，取值于实数轴上的函数叫随机变量

设随机试验的样本空间为S={e}, X=X(e)是定义在样本空间S上的实值单值函数。称X=X(e)为**随机变量**。

随机变量可以分为：**离散型随机变量**和**非离散型随机变量**，其中非离散型随机变量主要以**连续型随机变量为主**。
**离散型随机变量**：随机变量可能取到的值时有限个数或可列无限多个
**连续型随机变量**：随机变量可能取到的值时无限个数

### 分布函数

#### 定义

X是随机变量，x是任意实数，则分布函数为：F(x)=P(X⩽x),x∈(−∞,∞)。或称X服从分布F(x)，记为$X \sim F(x)$

则对于任意实数x1, x2，有 P{x1 < X <= x2} = F(x2) - F(x1)

#### 性质

（1）F(x)是不减函数;

（2）有界：0<=F(x)<=1, 且 F(-inf) = 0, F(inf) = 1; 

​		$F(-\infty)=lim_{x \to -\infty}F(x)=0$

​	$F(+\infty)=lim_{x \to +\infty}F(x)=1$

（3）F(x+0) = F(x)，即F(x) 右连续

#### 应用

$$
P(X \leq a)=F(a) \\
P(X < a) = F(a-0) \\
P(X = a)=F(a)-F(a-0)
$$

### 常见的随机变量分布类型

#### 离散型

##### （1）0-1分布 B(1,p)

事件只有发生和不发生两种可能，发生的概率为p，则不发生的概率为（1-p），
那么P{X=k} = $p^k(1-p)^{1-k}, k = 0,1$

##### （2）二项分布B(n,p)

**伯努利试验**：一次试验只有两种可能结果，发生A，或不发生A'，并且P(A) = p, P(A') = 1-p
**n次独立重复的伯努利试验服从二项分布**：设X表示事件A发生的次数，则$P{X=k} = C(n,k)p^k(1-p)^{n-k}$, k = 0,1,...,n ，记为X~B(n,p)，即X服从参数为n，p的二项分布。
注意：**重复**是指每次试验p不变；**独立**是指各次结果互不影响。

##### （3）泊松分布P($\lambda$)

如果X的概率分布为$P(X=k)=\frac{\lambda^k}{k!}e^{-\lambda},(k=0,1,...; \lambda > 0)$，则称X服从参数$\lambda $的泊松分布，记为$X \sim P(\lambda)$

当n很大时，泊松分布近似等于二项分布，并且 $\lambda = np$. 即 $C(n,k)p^k(1−p)^{n−k}≈\frac{λ^ke^{−λ}}{k!}(λ=np)$

定理表明当n很大时，p很小，上式常用来作二项分布概率的近似计算。

实际中很多事件服从泊松分布：一本书一页中的印刷错误数，某地区在一天内邮递遗失的信件数、某一医院在一天内的急诊病人数、某一地区一个时间间隔内发生交通事故的次数，在一个时间间隔内某种放射性物质发出的、经过计算机的粒子数等。
（可以发现这些例子中，都是**小概率事件**，从实际中与泊松定理联系起来。）

##### （4）几何分布G(p)

其实是叫错了，应该是首中即停止。伯努利-n为无穷的情况

如果X的概率分布为P(X=k)=$(1-p)^{k-1}p^{(k=1,2,...;0<p<1)}$，则称X服从参数为p的几何分布，记为$X \sim G(p)$

设X表示Bonnie试验中事件A首次发生所需做的试验次数，则X~G(p)，其中p=P(A)

##### （5）超几何分布H(n,N,M)

其实是古典概型的特例，如果X的概率分布为
$$
P(X=k)=\frac{C^k_MC^{n-k}_{N-M}}{C^n_N}
$$
其中，max{0,n-N+M}<=k<=min{M,n}；M，N，n为正整数且M<=N,n <=N, k为整数。则称X服从参数为(n,N,M)的超几何分布，记为$X \sim H(n,N,M)$

#### 连续型

对于连续型随机变量X，f(x)称为X的**概率密度函数**，简称**概率密度**。分布函数定义如下：
$$
F(x)=∫^x_{−∞}f(t)dt
$$
概率密度函数的积分，即围成的面积，为随机变量落入某一区间的概率,如图所示:
$$
P(x1⩽X⩽x2)=∫^{x2}_{x1}f(t)dt
$$

##### (1)均匀分布U(a,b)

随机变量落入区间（a，b）中任意等长度的子区间内的可能性是相同的。或者说它落入（a，b）区间内的概率只依赖于子区间内的长度而与子区间的位置无关。 X~U（a,b）

```
概率密度
if a<x<b : 
	f(x) = 1/(b-a)
else : 
	f(x) = 0 
```

分布函数
$$
F(x)=\begin{cases}
0, & x < a \\
\frac{x-a}{b-a}, &a\leq x < b \\
1, & x \ge b
\end{cases}
$$

##### (2)指数分布E($\lambda$ )

概率密度
$$
f(x)=\begin{cases}
\lambda e^{-\lambda x}, & x>0 \\
0, &其他
\end{cases}
$$
分布函数
$$
f(x)=\begin{cases}
1- e^{-\lambda x}, & x\ge0 \\
0, & x < 0
\end{cases}
$$
其中 $\lambda > 0$. 称X服从参数$\lambda $的指数分布，记为 $X \sim E(\lambda)$

##### (3)正态分布N($\mu, \sigma^2$)

$$
f(x)=\frac{1}{\sqrt{2\pi}\sigma}e^{\frac{(x-\mu)^2}{2\sigma^2}},−∞<x<∞
$$

其中μ,σ为常数，分别表示均值和标准差，记作 $X \sim N(\mu, \sigma^2)$

均值为0，方差为1的正态分布称为标准正态分布，记为X~N(0,1)。任何一个正态分布都可以通过标准化操作转换成标准正态分布，标准化操作等式如下：
$$
X^* = \frac{X-\mu}{\sigma}
$$
**高斯分布的“3σ”法则** ： μ−3σ范围的覆盖率已经达到99.%以上。

3. 若X~N(0,1) P(X>$\mu _a$)=a, 则称$\mu _a$ 为标准正态分布的上侧$\alpha$分位数(上$\alpha 分位点$)
4. 

### 一维随机变量函数的分布

#### 概念

设X为随机变量，函数y=g(x)，则以随机变量X作为自变量的函数Y=g(X)也是随机变量，称为随机变量X的函数

#### 随机变量函数的分布

##### 离散型

设X为离散型随机变量，其概率分布为pi=P(X=xi)(i=1,2,……)，则X的函数Y=g(X)也是离散型随机变量，其概率分布为P{Y=g(xi)}=pi(i=1,2,...)。

如果有若干个g(xi)相同，则合并诸项为一项g(xi)，并将相应概率相加作为Y取g(xk)值的概率

##### 连续型

设X为连续型随机变量，其分布函数、概率密度分别为$F_x(x)$和$f_x(x)$，随机变量Y=g(X)是X的函数，则Y的分布函数或概率密度可以用分布函数法求得
$$
F_Y(y)=P(Y\leq y)=P\{g(X)\leq y\}=\int_{g(X)\leq y}f_X(x)dx
$$
如果$F_Y(y)$连续，且除有限个点外，$F'_Y(y)$存在且连续，则Y的概率密度$f_Y(y)=F'_Y(y)$

## 多维随机变量及其分布

### 多维随机变量的概念

如果X1,X2,...,Xn是定义在同一个样本空间$\Omega$上的n个随机变量，则称(X1,X2,...,Xn)为n维随机变量或n维随机向量，Xi(i=1,2,...,n)称为第i个分量.

n=2时，记(X,Y)为二维随机变量（或二维随机向量）

### 多维随机变量的分布函数

#### 概念

对任意的n个实数x1,x2,...,xn，称n元函数
$$
F(x1,x2,..,xn)=P\{X1 \leq x1,X2 \leq x2,
\dots ,Xn \leq xn,\}
$$
为n维随机变量(X1,X2,...,Xn)的联合分布函数。

当n=2时，则对任意的实数x,y 称二元函数
$$
F(x,y)=P\{X \leq x, Y\leq y\}
$$
为二维随机变量(X,Y)的联合分布函数，简称分布函数，记为(X,Y)~F(x,y)

#### 性质

1. 单调性
2. 右连续性
3. 有界性
4. 非负性

### 边缘分布函数

设二维随机变量(X,Y)的联合分布函数为F(x,y)，随机变量X与Y的分布函数$F_X(x)$与$F_Y(y)$分别称为(X,Y)关于X和关于Y的边缘分布函数
$$
F_X(x)=P(X⩽x)=P(X⩽x,Y<∞)=F(x,∞) \\
F_Y(y)=P(Y⩽y)=P(X<∞,Y⩽y)=F(∞,y)
$$

### 常见的两类二维随机变量

#### 二维离散型随机变量

##### 分布函数

$$
F(x,y)=P(X⩽x,Y⩽y),−∞<x<∞,−∞<y<∞
$$

##### 分布律

$$
P(X=xi,Y=yi)=p_{ij},i=1,2,...(p_{ij}⩾0,∑_{i=1}^∞∑_{j=1}^∞p_{ij}=1)
$$

数列{$p_{ij}$} i,j=1,2,... 是某一二维离散型随机变量的概率分布的充分必要条件为
$$
p_{ij} \geq 0, \sum_{i=1}^{\infty}\sum_{j=1}^{\infty}p_{ij}=1
$$

##### 边缘分布

$$
p_{i*}=P(X=x_i)=\sum_{j=1}^{\infty}P(X=x_i,Y=y_j)=\sum_{j=1}^{\infty}p_{ij}(j=1,2,...) \\
p_{*j}=P(Y=y_j)=\sum_{i=1}^{\infty}P(X=x_i,Y=y_j)=\sum_{i=1}^{\infty}p_{ij}(i=1,2,...)
$$

##### 条件分布

如果(X,Y)~pij 对固定的j，如果p*j=P(Y=yj)>0, 则称
$$
P\{X=x_i|Y=y_j\}=\frac{P\{X=x_i,Y=y_j\}}{P\{Y=y_j\}}=\frac{p_{ij}}{p{*j}}(i=1,2,...)
$$
为X在“Y=yi”条件下的条件分布。

同理可得，Y在“X=xi"条件下的条件分布
$$
P\{Y=y_j|X=x_i\}=\frac{p_{ij}}{p_{i*}}(j=1,2,...)
$$

#### 二维连续型随机变量

##### 分布函数

1. F(x,y)为(x,y)的二元连续函数，且

$$
F(x,y)=∫^y_{−∞}∫^x_{−∞}f(x,y)dxdy,f(x,y)>0
$$

2. 设G为平面上某个区域


$$
P((X,Y)∈G)=∬_Gf(x,y)dxdy
$$
​		这是计算概率，求随机变量分布函数的依据

3. 若F(x,y)连续且可导，则(X,Y)是连续型随机变量，则$\frac{\partial^2F(x,y)}{\partial x\partial y}$是它的概率密度
4. 若f(x,y)在点(x,y)处连续，则$\frac{\partial^2F(x,y)}{\partial x\partial y}=f(x,y)$

##### 边缘概率密度

设(X,Y)~f(x,y),则X的边缘分布函数为
$$
F_X(x)=F(x,+\infty)=\int^x_{-\infty}[\int^{+\infty}_{-\infty}f(u,v)dv]du
$$
所以X是连续型随机变量，其概率密度
$$
f_X(x)=\int^{+\infty}_{-\infty}f(x,y)dy
$$
$f_X(x)$是(X,Y)关于X的边缘概率密度，同理Y也是连续型随机变量，其概率密度为$f_Y(y)=\int^{+\infty}_{-\infty}f(x,y)dx$

##### 条件概率密度

$$
f_{Y|X}(y|x)=\frac{f(x,y)}{f_Y(y)}
$$

##### 相互独立

$$
F(x,y)=F_X(x)F_Y(y)\\
f(x,y)=f_X(x)f_Y(y)\\
P(X=x_i,Y=y_j)=P(X=x_i)P(Y=y_j)\\
$$

### 常见的二维分布

#### 二维均匀分布

称(X,Y)在平面有界区域D上服从均匀分布，如果(X,Y)的概率密度为
$$
f(x,y)=\begin{cases}
\frac{1}{S_D}, & (x,y) \in D \\
0, & 其他
\end{cases}
$$

#### 二维正态分布

(公式太长，懒得打了……)

## 随机变量的数字特征

### 一维随机变量的数字特征

#### 期望

**数学期望**简称**期望**，又称为**均值**。 数学期望完全由随机变量的分布所确定，若X服从某一分布，也称E(X)是这一分布的数学期望。
**离散型随机变量:**【前提是级数绝对收敛，否则期望不存在】
$$
E(X)=∑_{k=1}^∞x_kp_k
$$
**连续型随机变量：**【前提是绝对收敛，否则期望不存在】
$$
E(X)=∫^∞_{−∞}xf(x)dx
$$
**数学期望几个重要性质**

1. 设C是常数，则有E(C) = C.
2. 设X是一个随机变量，C是常数，则有：E(CX) = CE(X).
3. 设X，Y是两个随机变量，则有：E(X+Y) = E(X)+E(Y)
4. 设X, Y是相互独立的随机变量，则有：E(XY) = E(X)E(Y)

#### 方差

方差表达了随机变量X的取值与其数学期望的偏离程度。
$$
D(X)=Var(X)=E([X−E(X)]^2)\\
σ(X)=\sqrt{D(X)}
$$
由定义可知，方差实际上就是随机变量X的函数
$$
g(X)=(X−E(X))^2
$$
的数学期望，因此

离散型随机变量的方差：
$$
D(X)=∑_{k=1}^∞[x_k−E(X)]^2p_k
$$
连续型随机变量的方差：
$$
D(X)=∫^∞_{−∞}[x−E(X)]^2f(x)dx
$$
随机变量X的方差可按下列公式计算（常用）：
$$
D(X)=E(X^2)−[E(X)]^2
$$
几个重要性质:

1. DX>=0, $E(X^2)=DX+(EX)^2>=(EX)^2$

2. Dc=0 c为常数

3. D(aX+b)=$a^2DX$

4. $D(X\pm Y)=DX+DY\pm 2Cov(X,Y)$

   $Cov(X,Y)=E((X−E(X))(Y−E(Y)))$

5. 若X,Y相互独立，则

   $D(X+Y)=D(X)+D(Y)$

   $D(aX+bY)=a^2DX+b^2DY$

6. D(X)=0的充要条件是X以概率1取常数E(X)，即 P{X=E(X)} = 1

#### 切比雪夫（Chebyshev）不等式

切比雪夫不等式给出了在随机变量的分布未知，而只知道E(X)和D(X)的情况下估计概率 P{|X-E(X)|<epsilon}的界限，epsilon是任意正数。
$$
P(|X−μ|⩾ε)⩽\frac{σ2}{ε^2} \\
P(|X−μ|<ε)⩾1−\frac{σ2}{ε^2}
$$

### 二维随机变量的数字特征

#### 数学期望

##### 离散型

前提是级数绝对收敛
$$
E(g(X,Y))=\sum_i\sum_jg(x_i,y_j)p_{ij}
$$

##### 连续型

前提是积分绝对收敛
$$
E[g(X,Y)]=\int^{+\infty}_{-\infty}g(x,y)f(x,y)dxdy
$$

#### 协方差

如果随机变量X与Y的方差存在且DX>0, DY>0,则称$E[(X-EX)(Y-EY)]$为随机变量X与Y的协方差，记为Cov(X,Y)即
$$
Cov(X,Y)=E[(X-EX)(Y-EY)]=E(XY)-EX\cdot EY
$$
其中
$$
E(XY)=\begin{cases}
\sum_i\sum_jx_iy_jP\{X=x_i,Y=y_j\} (离散型),\\
\int^{+\infty}_{-\infty}\int^{+\infty}_{-\infty}xyf(x,y)dxdy(连续型)
\end{cases}
$$
称$\rho_{XY}=\frac{Cov(X,Y)}{\sqrt{DX}\sqrt{DY}}$为随机变量X和Y的相关系数，如果$\rho_{XY}=0$则称X与Y不相关，如果$\rho_{XY}\ne0$，则称X与Y相关

性质：

1. 对称

   1. Cov(X,Y)=Cov(Y,X), $\rho_{XY}=\rho_{YX}$
   2. Cov(X,X)=DX, $\rho_{XX}=1$

2. 线性性

   1. Cov(X,c)=0, Cov(aX+b,Y)=aCov(X,Y)
   2. Cov(X1+X2,Y)=Cov(X1,Y)+Cov(X2,Y)

3. 一般的 

   $Cov(\sum^n_{i=1}a_iX_i,Y)=\sum^n_{i=1}a_iCov(X_i,Y)$

4. 相关系数有界性 $|\rho_{XY}\leq1|$

5. 如果Y=aX+b, 则
   $$
   \rho_{XY}=\begin{cases}
   1, &a>0 \\
   -1, &a<0
   \end{cases}
   $$

### 独立性与相关性判定

_注意：_相关系数也称为线性相关系数，它是一个可以用来描述随机变量（X，Y）的两个分量X，Y之间的线性关系紧密程度的数字特征。当相关系数较小时，X，Y的线性相关程度较差；当相关系数=0时称X，Y不相关。**值得注意的是，不相关是指X，Y之间不存在线性关系，它们还可能存在除线性关系之外的关系**。
**X，Y相互独立是对X，Y的一般关系而言。X，Y相互独立则X，Y一定不相关；反之，若X，Y不相关则X,Y不一定相互独立**。
**特别的，**对于二维正态随机变量（X，Y），X和Y不相关与X和Y相互独立是等价的。

### 矩阵、协方差矩阵

##### k阶原点矩(k阶矩)

$$
E(X^k),k=1,2,...
$$

##### k阶中心矩

$$
E([X−E(X)]^k),k=2,3,...
$$



##### k+l阶混合矩

$$
E(X^kY^l),k,l=1,2,....
$$



##### k+l阶混合中心矩

$$
E([X−E(X)]^k[Y−E(Y)]^l),k,l=1,2,...
$$



##### 协方差矩阵

$$
c_{ij}=Cov(X_i,X_j)=E([X_i−E(X_i)][X_j−E(X_j)]),i,j=1,2,...,n
$$

一般n维随机变量的分布是不知道的，或者是太复杂，以至于在数学上不易处理，因此在实际引用中协方差矩阵显得尤为重要。

## 大数定理与中心极限定理

假设检验

参数检验

非参检验

AB实验分析流程

AB效果分析
